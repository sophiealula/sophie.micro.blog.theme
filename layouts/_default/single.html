{{ define "main" }}
{{ if eq .Title "Media" }}
<div class="media-page">
  <h1 class="page-title">Media</h1>
  <p class="media-intro">Here's what I'm reading and bookmarking, updated {{ now.Format "January 2, 2006" }}.</p>

  {{ with .Site.Data.bookshelves.currentlyreading }}
  <section class="media-section">
    <h2>Currently Reading</h2>
    <div class="media-grid">
      {{ range . }}
      {{ $book := . }}
      <a href="https://micro.blog/books/{{ .isbn }}" class="media-card" target="_blank" rel="noopener">
        <div class="media-cover">
          {{ with .cover_url }}
          <img src="{{ . }}" alt="{{ $book.title }} cover" loading="lazy">
          {{ end }}
        </div>
        <div class="media-info">
          <span class="media-title">{{ .title }}</span>
          <span class="media-artist">{{ .author }}</span>
        </div>
      </a>
      {{ end }}
    </div>
  </section>
  {{ end }}

  {{ with .Site.Data.bookshelves.finishedreading }}
  <section class="media-section">
    <h2>Recently Finished</h2>
    <div class="media-grid">
      {{ range first 6 . }}
      {{ $book := . }}
      <a href="https://micro.blog/books/{{ .isbn }}" class="media-card" target="_blank" rel="noopener">
        <div class="media-cover">
          {{ with .cover_url }}
          <img src="{{ . }}" alt="{{ $book.title }} cover" loading="lazy">
          {{ end }}
        </div>
        <div class="media-info">
          <span class="media-title">{{ .title }}</span>
          <span class="media-artist">{{ .author }}</span>
        </div>
      </a>
      {{ end }}
    </div>
  </section>
  {{ end }}

  {{ with .Content }}
  <section class="media-section">
    <h2>Bookmarks</h2>
    {{ . }}
  </section>
  {{ end }}
</div>
{{ else }}
<article class="post single">
  {{ if .Title }}
  <h1 class="post-title">{{ .Title }}</h1>
  {{ end }}
  <div class="post-content">
    {{ .Content }}
  </div>
  <div class="post-meta">
    <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
      {{ .Date.Format "Jan 2, 2006 at 3:04 PM" }}
    </time>
  </div>
</article>
{{ end }}
{{ end }}
